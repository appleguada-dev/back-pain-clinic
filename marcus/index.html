<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BackRx | ุจุฑูุชูููู ูุงุฑููุณ ุงูุนูุงุฌู</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <style>
        body { font-family: 'Tajawal', sans-serif; }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
        
        /* Custom Scrollbar (Cyan Theme) */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #0891b2; border-radius: 4px; }

        .ltr-text { direction: ltr; display: inline-block; font-family: sans-serif; }

        /* Animation for the Guide Button */
        @keyframes float {
            0% { transform: translateY(0px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
            50% { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2); }
            100% { transform: translateY(0px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        }
        .float-anim { animation: float 3s ease-in-out infinite; }

        /* Print Styles */
        @media print {
            body, html, #app, main, .flex-1 {
                height: auto !important;
                min-height: 100% !important;
                overflow: visible !important;
                position: static !important;
                display: block !important;
            }
            aside, header, .no-print, button, .buttons-container, .guide-btn { display: none !important; }
            .printable-area, .printable-area * { visibility: visible !important; }
            .printable-area {
                position: relative !important;
                left: 0 !important;
                top: 0 !important;
                width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                box-shadow: none !important;
                background: white !important;
            }
            ul li, .card-break { page-break-inside: avoid; }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 h-screen overflow-hidden selection:bg-cyan-200">

<div id="app" class="h-full flex flex-col md:flex-row">

    <aside class="w-full md:w-80 bg-gradient-to-b from-slate-900 to-slate-800 text-white flex flex-col shadow-2xl z-20 shrink-0 h-full no-print">
        <div class="p-6 bg-cyan-700 shadow-lg relative overflow-hidden">
            <div class="absolute -top-10 -left-10 w-32 h-32 bg-white/10 rounded-full blur-2xl"></div>
            <h1 class="text-2xl font-black flex items-center gap-3 relative z-10">
                <span class="text-3xl">๐งฌ</span> BackRx
            </h1>
            <p class="text-cyan-100 text-xs mt-1 font-bold tracking-wider relative z-10 opacity-90">ุจุฑูุชูููู ูุงุฑููุณ (Kraus-Weber)</p>
        </div>

        <div class="flex-1 overflow-y-auto p-4 space-y-6">
            <div>
                <div class="flex justify-between text-xs text-slate-400 mb-2 font-bold">
                    <span>ูุฑุญูุฉ ุงููุญุต</span>
                    <span>{{ Math.round(progress) }}%</span>
                </div>
                <div class="w-full bg-slate-700 h-3 rounded-full overflow-hidden shadow-inner">
                    <div class="bg-gradient-to-l from-cyan-400 to-cyan-600 h-full transition-all duration-1000 ease-out relative" :style="{ width: progress + '%' }"></div>
                </div>
            </div>

            <div>
                <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-3 border-b border-slate-700 pb-2 flex justify-between items-center">
                    <span>ููุงุท ุงูุถุนู (Failures)</span>
                    <span class="bg-red-500 text-white text-[10px] px-2 py-0.5 rounded-full">{{ failedTests.length }}</span>
                </h3>
                
                <div v-if="failedTests.length === 0" class="text-sm text-slate-500 italic text-center py-6 border border-dashed border-slate-700 rounded-lg">
                    ุจุงูุชุธุงุฑ ุงููุชุงุฆุฌ...
                </div>
                
                <transition-group name="fade" tag="div" class="space-y-2">
                    <div v-for="(test, i) in failedTests" :key="i" class="bg-red-900/30 border-r-4 border-red-500 p-3 rounded-lg text-sm cursor-default group">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-bold text-red-200 text-xs">{{ test.name }}</span>
                        </div>
                        <div class="text-xs text-slate-300 leading-snug truncate">ุชู ุชุณุฌูู ุงูุถุนู ูู ุงูุณุฌู</div>
                    </div>
                </transition-group>
            </div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-full relative overflow-hidden bg-slate-50">
        
        <header class="bg-white px-6 py-4 shadow-sm border-b flex justify-between items-center z-10 no-print">
            <div>
                <h2 v-if="currentPhase === 'history'" class="text-xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="bg-blue-100 text-blue-700 p-1.5 rounded-lg text-sm">1</span>
                    ุงููุญุต ุงูุฃููู (Safety)
                </h2>
                <h2 v-else-if="currentPhase === 'physical'" class="text-xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="bg-cyan-100 text-cyan-700 p-1.5 rounded-lg text-sm">2</span>
                    ุงุฎุชุจุงุฑุงุช ูุฑุงูุณ-ููุจุฑ ({{ physicalIndex + 1 }}/6)
                </h2>
                <h2 v-else-if="currentPhase === 'final'" class="text-xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="bg-purple-100 text-purple-700 p-1.5 rounded-lg text-sm">3</span>
                    ุงูุฎุทุฉ ุงูุนูุงุฌูุฉ
                </h2>
                <h2 v-else class="text-xl font-bold text-slate-800">ูุฑุญุจุงู ุจู</h2>
            </div>
            <div class="text-xs font-bold text-slate-400 bg-slate-100 px-3 py-1 rounded-full">Kraus-Weber Protocol โข</div>
        </header>

        <div class="flex-1 overflow-y-auto p-4 md:p-8 relative" id="main-scroll">
            
            <div v-if="currentPhase === 'intro'" class="max-w-2xl mx-auto mt-10 animate-fade-in-up">
                <div class="bg-white p-10 rounded-3xl shadow-2xl text-center border border-slate-100 relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-cyan-400 to-blue-500"></div>
                    <div class="w-24 h-24 bg-cyan-50 rounded-full flex items-center justify-center text-5xl mx-auto mb-6 shadow-sm">๐งฌ</div>
                    <h2 class="text-4xl font-black text-slate-800 mb-4 tracking-tight">ูุธุงู BackRx ููุนููุฏ ุงูููุฑู</h2>
                    <p class="text-slate-600 mb-6 leading-relaxed text-lg">
                        ุชุนุชูุฏ ูุฐู ุงููููุฌูุฉ ุนูู ุฃุจุญุงุซ ุงูุฏูุงุชุฑุฉ "ูุงูุฒ ูุฑุงูุณ" ู"ููุฑูุงู ูุงุฑููุณ".
                        <br><strong>ุงูููุณูุฉ:</strong> ุฃูู ุงูุธูุฑ ุบุงูุจุงู ูุง ูููู ูุดููุฉ ูู "ุงูุนุถูุงุช" (Software) ูููุณ "ุงูุนุธุงู" (Hardware).
                    </p>
                    
                    <div class="bg-amber-50 border border-amber-200 rounded-xl p-5 mb-8 text-right shadow-sm">
                        <h4 class="text-amber-800 font-bold mb-2 flex items-center gap-2"><span>โ๏ธ</span> ุชูููู ุทุจู ูุงู</h4>
                        <p class="text-amber-700 text-sm leading-relaxed mb-4 font-medium">
                            ูุฐุง ุงูุชุทุจูู ูุณุงุนุฏู ุนูู ุงูุชุดุงู ุงูุนุถูุงุช ุงูุถุนููุฉ ุฃู ุงููุชุดูุฌุฉ. ูุง ูุญู ูุญู ุงูุทุจูุจ. ุฅุฐุง ุดุนุฑุช ุจุฃูู ุญุงุฏ (Acute Pain) ุฃุซูุงุก ุฃู ุงุฎุชุจุงุฑุ ุชููู ููุฑุงู.
                        </p>
                        <label class="flex items-center gap-3 cursor-pointer group bg-white p-3 rounded-lg border border-amber-100 hover:border-amber-300 transition-colors">
                            <input type="checkbox" v-model="disclaimerAccepted" class="w-5 h-5 accent-cyan-600 rounded border-gray-300">
                            <span class="text-sm font-bold text-slate-700">ูููุช ุฐููุ ูุฃูุงูู ุนูู ุงููุชุงุจุนุฉ.</span>
                        </label>
                    </div>

                    <div class="grid grid-cols-2 gap-4 text-right bg-slate-50 p-6 rounded-2xl border border-slate-200 mb-8">
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">ุงูุงุณู</label>
                            <input v-model="user.name" class="w-full bg-white border border-slate-300 rounded-lg p-3 outline-none focus:border-cyan-500 transition-colors">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 mb-1">ุงูุนูุฑ</label>
                            <input v-model.number="user.age" type="number" class="w-full bg-white border border-slate-300 rounded-lg p-3 outline-none focus:border-cyan-500 transition-colors">
                        </div>
                    </div>
                    <button @click="startApp" :disabled="!user.name || !disclaimerAccepted" class="w-full bg-cyan-600 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:bg-cyan-700 transition-all transform hover:-translate-y-1 disabled:opacity-50 disabled:cursor-not-allowed">
                        ุงุจุฏุฃ ุงูุชูููู ุงูุขู
                    </button>
                </div>
            </div>

            <div v-if="currentPhase === 'history'" class="max-w-3xl mx-auto">
                <div v-if="historyIndex === -1" class="bg-white rounded-2xl shadow-xl p-8 mb-6 animate-fade-in-up border-l-8 border-cyan-500">
                    <h3 class="text-2xl font-bold text-slate-800 mb-4">ุงููุฑุญูุฉ ุงูุฃููู: ุงูุฃูุงู ูุงููุญุต ุงูุฃููู</h3>
                    <div class="text-slate-600 leading-relaxed space-y-4 mb-8 text-base font-medium">
                        <p>
                            ูุจู ุฃู ูุจุฏุฃ ูู ุงูุงุฎุชุจุงุฑุงุช ุงูุฌุณุฏูุฉ (Kraus-Weber Tests)ุ ูุฌุจ ุฃู ูุชุฃูุฏ ูู ุฃูู ูุณุช ูู ุญุงูุฉ ุฅุตุงุจุฉ ุญุงุฏุฉ ุชููุนู ูู ุงูุญุฑูุฉ.
                        </p>
                        <div class="bg-blue-50 p-5 rounded-xl border border-blue-200">
                            <strong>ุงููุฏู:</strong> ุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุงูุฃูู ูุงุชุฌุงู ุนู "ุชุดูุฌ ุนุถูู" (Muscle Tension) ุฃู ุถุนูุ ููู ูุง ูุนุงูุฌู ูุฐุง ุงูุจุฑูุงูุฌุ ุฃู ูุดููุฉ ุทุจูุฉ ุทุงุฑุฆุฉ.
                        </div>
                    </div>
                    <button @click="historyIndex = 0" class="w-full bg-slate-800 text-white py-4 rounded-xl font-bold hover:bg-slate-900 transition-colors flex justify-center items-center gap-2 shadow-lg">
                        <span>ุงุจุฏุฃ ุงููุญุต ุงูุฃููู</span>
                        <span>&larr;</span>
                    </button>
                </div>

                <div v-else class="transition-all duration-300">
                    <div v-if="!safetyPassed" class="bg-white rounded-2xl shadow-xl p-8 mb-6 animate-fade-in-up border-l-8 border-red-500">
                        <h3 class="text-2xl font-bold text-red-800 mb-4">ุชููู!</h3>
                        <p class="text-slate-600 text-lg">ุจูุงุกู ุนูู ุฅุฌุงุจุชูุ ุญุงูุชู ุชุชุทูุจ ุนูุงูุฉ ุทุจูุฉ ููุฑูุฉ ููุง ุชูุงุณุจ ุงูุชูุงุฑูู ุงูููุฒููุฉ ุญุงููุงู.</p>
                        <button @click="resetApp" class="mt-6 px-6 py-3 bg-slate-800 text-white rounded-lg">ุฅุนุงุฏุฉ ุงูุจุฏุก</button>
                    </div>

                    <div v-else>
                        <div v-if="!lastAnswerNote" class="bg-white rounded-2xl shadow-lg p-8 mb-6 animate-fade-in-up">
                            <div class="mb-6 flex justify-between items-center">
                                <span class="text-xs font-bold text-cyan-700 bg-cyan-100 px-3 py-1 rounded-full">ุณุคุงู ุงูุฃูุงู {{ historyIndex + 1 }} / 3</span>
                            </div>
                            <h3 class="text-2xl font-bold mb-8 text-slate-800 leading-snug">{{ currentHistoryQ.text }}</h3>
                            <div class="space-y-4">
                                <button v-for="opt in currentHistoryQ.options" @click="handleHistoryAnswer(opt)" class="w-full text-right p-5 rounded-xl border-2 border-slate-100 hover:border-cyan-500 hover:bg-cyan-50 transition-all flex justify-between items-center group">
                                    <span class="font-bold text-slate-700 text-lg">{{ opt.label }}</span>
                                    <div class="w-6 h-6 rounded-full border-2 border-slate-300 group-hover:border-cyan-500 group-hover:bg-cyan-500 flex items-center justify-center transition-colors">
                                        <span class="text-white text-xs opacity-0 group-hover:opacity-100">โ</span>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <div v-else class="bg-blue-50 border-r-8 border-blue-500 p-8 rounded-2xl shadow-lg mb-6 animate-fade-in-up">
                            <div class="flex items-center gap-3 mb-4">
                                <span class="text-3xl bg-white p-2 rounded-full shadow-sm">๐ก</span>
                                <h4 class="font-bold text-blue-900 text-xl">ุชูุฌูู ุทุจู:</h4>
                            </div>
                            <p class="text-slate-800 text-lg leading-8 mb-8 font-medium text-justify">{{ lastAnswerNote }}</p>
                            <button @click="nextHistoryQuestion" class="w-full bg-blue-600 text-white py-4 rounded-xl font-bold hover:bg-blue-700 shadow-lg transition-transform hover:scale-[1.01]">
                                ุงูุชุงูู &larr;
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="currentPhase === 'physical'" class="max-w-7xl mx-auto h-full flex flex-col lg:flex-row gap-8">
                <div class="w-full lg:w-1/2 flex flex-col gap-6">
                    <div class="bg-white p-3 rounded-2xl shadow-xl border border-slate-200">
                        <div class="relative aspect-[4/3] bg-slate-100 rounded-xl overflow-hidden flex items-center justify-center group">
                            <img :src="currentPhysicalTest.image" :alt="currentPhysicalTest.title" class="w-full h-full object-contain p-2">
                            <div class="absolute top-4 left-4 bg-white/90 backdrop-blur text-slate-800 text-xs font-bold px-3 py-1 rounded-full shadow-sm">
                                ุงุฎุชุจุงุฑ ูุฑุงูุณ-ููุจุฑ ุฑูู {{ physicalIndex + 1 }}
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-8 rounded-2xl shadow-md border-t-4 border-cyan-500 flex-1">
                        <h3 class="text-cyan-800 font-bold mb-4 flex items-center gap-2 text-lg"><span>๐</span> ุชุนูููุงุช ุงูุฃุฏุงุก:</h3>
                        <div class="text-slate-600 text-base leading-relaxed space-y-4" v-html="currentPhysicalTest.instruction"></div>
                    </div>
                </div>

                <div class="w-full lg:w-1/2 flex flex-col justify-center pb-10">
                    <transition name="fade" mode="out-in">
                        <div v-if="!currentTestResult" class="bg-white p-10 rounded-3xl shadow-2xl border border-slate-100">
                            <h3 class="text-2xl font-black text-slate-800 mb-8 leading-snug">{{ currentPhysicalTest.question }}</h3>
                            <div class="space-y-4">
                                <button v-for="opt in currentPhysicalTest.options" @click="handlePhysicalAnswer(opt)" class="w-full text-right p-6 rounded-2xl border-2 border-slate-100 hover:border-cyan-500 hover:bg-cyan-50 hover:shadow-lg transition-all flex justify-between items-center group">
                                    <span class="font-bold text-slate-700 text-lg group-hover:text-cyan-800">{{ opt.label }}</span>
                                    <span class="text-2xl text-slate-300 group-hover:text-cyan-500 transition-colors">โ</span>
                                </button>
                            </div>
                        </div>

                        <div v-else class="bg-white rounded-3xl shadow-2xl border-2 border-cyan-100 overflow-hidden">
                            <div class="bg-cyan-50 p-8 border-b border-cyan-100">
                                <div class="flex items-center gap-3 mb-3">
                                    <span class="text-3xl">๐</span>
                                    <h3 class="text-2xl font-bold text-cyan-900">ุงูุชุญููู ุงูุทุจู ุงูุนููู:</h3>
                                </div>
                                <p class="text-slate-800 leading-8 font-medium text-lg mb-6 text-justify">{{ currentTestResult.feedback }}</p>
                                
                                <div class="flex items-center gap-3">
                                    <div class="text-sm font-bold text-slate-500">ุงูุญุงูุฉ:</div>
                                    <div :class="currentTestResult.passed ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'" class="inline-block px-4 py-2 rounded-lg text-sm font-bold shadow-sm">
                                        {{ currentTestResult.passed ? 'โ ุนุถูุงุช ุณูููุฉ (Passed)' : 'โ ุถุนู ุนุถูู (Below Par)' }}
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 divide-x divide-x-reverse divide-slate-100">
                                <div class="p-6 bg-green-50/50">
                                    <h4 class="text-green-700 font-black mb-4 flex items-center gap-2 text-lg"><span>โ</span> ุงูุนู</h4>
                                    <ul v-if="currentTestResult.dos.length > 0" class="text-sm text-slate-700 space-y-3 font-medium">
                                        <li v-for="tip in currentTestResult.dos" class="flex items-start gap-2"><span class="text-green-500 mt-1">โข</span> {{ tip }}</li>
                                    </ul>
                                    <p v-else class="text-xs text-slate-400">ุญุงูุธ ุนูู ูุดุงุทู ุงูุญุงูู.</p>
                                </div>
                                <div class="p-6 bg-red-50/50">
                                    <h4 class="text-red-700 font-black mb-4 flex items-center gap-2 text-lg"><span>โ</span> ุชุฌูุจ</h4>
                                    <ul v-if="currentTestResult.avoids.length > 0" class="text-sm text-slate-700 space-y-3 font-medium">
                                        <li v-for="tip in currentTestResult.avoids" class="flex items-start gap-2"><span class="text-red-500 mt-1">โข</span> {{ tip }}</li>
                                    </ul>
                                    <p v-else class="text-xs text-slate-400">ูุง ุชูุฌุฏ ูุญุงุฐูุฑ ุฎุงุตุฉ.</p>
                                </div>
                            </div>

                            <div class="p-6 bg-slate-50 border-t border-slate-100">
                                <button @click="nextPhysicalTest" class="w-full bg-slate-900 text-white py-4 rounded-xl font-bold hover:bg-black shadow-lg flex justify-center items-center gap-2 transition-all hover:scale-[1.02]">
                                    <span>ุญูุธ ุงููุชูุฌุฉ ูุงูุงูุชูุงู ููุชุงูู</span>
                                    <span>&larr;</span>
                                </button>
                            </div>
                        </div>
                    </transition>
                </div>
            </div>

            <div v-if="currentPhase === 'final'" class="max-w-5xl mx-auto printable-area bg-slate-50 p-0 animate-fade-in-up mb-20 relative">
                
                <div class="bg-slate-900 text-white p-12 rounded-b-[40px] shadow-2xl text-center relative overflow-hidden mb-12">
                    <div class="absolute top-0 left-0 w-full h-full bg-gradient-to-tr from-cyan-600/30 to-blue-600/30"></div>
                    <div class="relative z-10">
                        <h1 class="text-4xl font-black mb-2 tracking-tight">ุชูุฑูุฑ ุจุฑูุชูููู ูุงุฑููุณ</h1>
                        <p class="text-slate-400 text-lg font-light">ุชุญููู ููุงุท ุงูุถุนู ุงูุนุถููุฉ (The Weak Link)</p>
                        <div class="mt-6 inline-flex bg-white/10 backdrop-blur rounded-full px-6 py-2 text-sm">
                            <span class="text-cyan-300 font-bold ml-2">ุงููุณุชุฎุฏู:</span> {{ user.name }} | {{ new Date().toLocaleDateString('ar-EG') }}
                        </div>
                    </div>
                </div>

                <div class="px-8 max-w-6xl mx-auto">
                    
                    <div class="text-center mb-10">
                        <h2 class="text-3xl font-bold text-slate-800 inline-block border-b-4 border-cyan-500 pb-2">ุงูุชุดุฎูุต: {{ diagnosisTitle }}</h2>
                        <p class="text-slate-500 mt-2 text-lg">{{ diagnosisSubtitle }}</p>
                    </div>

                    <div class="bg-white rounded-3xl shadow-xl overflow-hidden border-2 border-cyan-100 mb-12">
                        <div class="bg-cyan-600 p-6 text-white flex justify-between items-center">
                            <h3 class="text-2xl font-bold">ุงูุจุฑูุงูุฌ ุงูููุชุฑุญ: {{ recommendedLevel.name }}</h3>
                            <span class="bg-white/20 px-4 py-1 rounded-full text-sm">ุงูุชุฑููุฒ: {{ recommendedLevel.focus }}</span>
                        </div>
                        <div class="p-8 text-center">
                            <button @click="openSpecificLevel(recommendedLevel.id)" class="inline-flex items-center gap-2 bg-slate-800 text-white px-8 py-5 rounded-2xl font-bold hover:bg-slate-900 shadow-xl transition-all hover:-translate-y-1">
                                <span class="text-2xl">๐</span>
                                <div class="text-right">
                                    <div class="text-xs font-light opacity-70">ุงูุชุญ ุงูุจุฑูุงูุฌ</div>
                                    <div>ุนุฑุถ ุชูุงุฑูู ุงููุณุชูู ุงูููุชุฑุญ</div>
                                </div>
                            </button>
                        </div>
                    </div>

                    <div class="mb-16 print-break">
                        <h3 class="text-xl font-black text-slate-800 mb-6 border-r-8 border-slate-400 pr-4">ุชุตูุญ ูุงูุฉ ุงููุณุชููุงุช (Browse All Levels)</h3>
                        <div class="grid md:grid-cols-3 gap-4">
                            <button @click="openSpecificLevel(1)" class="p-4 rounded-xl border border-cyan-200 bg-cyan-50 hover:bg-cyan-100 transition-colors text-right">
                                <div class="font-bold text-cyan-800 text-lg">ุงููุณุชูู 1</div>
                                <div class="text-xs text-cyan-600">ุงูุงุณุชุฑุฎุงุก (Relaxation)</div>
                            </button>
                            <button @click="openSpecificLevel(2)" class="p-4 rounded-xl border border-blue-200 bg-blue-50 hover:bg-blue-100 transition-colors text-right">
                                <div class="font-bold text-blue-800 text-lg">ุงููุณุชูู 2</div>
                                <div class="text-xs text-blue-600">ุงูุชูููุฉ (Mobilization)</div>
                            </button>
                            <button @click="openSpecificLevel(3)" class="p-4 rounded-xl border border-green-200 bg-green-50 hover:bg-green-100 transition-colors text-right">
                                <div class="font-bold text-green-800 text-lg">ุงููุณุชูู 3</div>
                                <div class="text-xs text-green-600">ุงููุชูุฏู (Maintenance)</div>
                            </button>
                        </div>
                    </div>

                    <div class="mb-16 print-break">
                        <h3 class="text-xl font-black text-slate-800 mb-6 border-r-8 border-slate-800 pr-4">ููุฎุต ุงุฎุชุจุงุฑุงุช ูุฑุงูุณ-ููุจุฑ</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div v-for="(test, i) in physicalLog" :key="i" :class="!test.passed ? 'border-red-200 bg-red-50' : 'border-green-200 bg-green-50'" class="p-4 rounded-xl border shadow-sm flex flex-col justify-between h-full card-break">
                                <div>
                                    <div class="text-xs font-bold uppercase mb-2" :class="!test.passed ? 'text-red-500' : 'text-green-500'">
                                        {{ !test.passed ? 'ูุดู (ููุทุฉ ุถุนู)' : 'ูุฌุงุญ (ููุฉ)' }}
                                    </div>
                                    <div class="font-bold text-slate-800 text-sm">{{ test.title }}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-center gap-4 no-print pb-12">
                        <button onclick="window.print()" class="px-8 py-4 bg-slate-800 text-white rounded-xl font-bold hover:bg-slate-900 shadow-lg flex items-center gap-2">
                            <span>๐จ๏ธ</span> ุญูุธ ุงูุชูุฑูุฑ PDF
                        </button>
                    </div>

                </div>
            </div>

        </div>
    </main>

    <div v-if="showProgram" class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4" @click.self="toggleProgram">
        <div class="bg-white w-full max-w-5xl rounded-[40px] p-8 shadow-2xl relative animate-fade-in-up overflow-hidden max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-6 pb-4 border-b border-slate-100 shrink-0">
                <div>
                    <h2 class="text-3xl font-black text-slate-800">{{ displayedLevel.name }}</h2>
                    <p class="text-cyan-600 font-bold">ุงูุชุฑููุฒ: {{ displayedLevel.focus }}</p>
                </div>
                <button @click="toggleProgram" class="bg-slate-100 rounded-full p-3 text-slate-500 hover:bg-slate-200 transition-colors">โ</button>
            </div>
            
            <div class="overflow-y-auto pr-2 space-y-8 flex-1">
                
                <div class="bg-slate-900 rounded-2xl p-6 text-center shadow-lg">
                    <h4 class="text-white font-bold mb-4">๐บ ููุฏูู ุชูุถูุญู ููุชูุงุฑูู</h4>
                    <a :href="displayedLevel.video" target="_blank" class="inline-flex items-center gap-2 bg-red-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-red-700 transition-transform hover:scale-105 no-underline shadow-lg">
                        ูุดุงูุฏุฉ ุงูููุฏูู ุนูู TikTok &rarr;
                    </a>
                </div>

                <div class="space-y-6">
                    <div v-for="(ex, index) in displayedLevel.exercises" :key="index" class="bg-slate-50 p-6 rounded-2xl border border-slate-200 hover:border-cyan-200 transition-colors">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-8 h-8 bg-cyan-600 text-white rounded-full flex items-center justify-center font-bold text-sm shrink-0">{{ index + 1 }}</div>
                            <div>
                                <h4 class="font-bold text-slate-800 text-lg">{{ ex.nameAr }}</h4>
                                <span class="text-xs text-slate-400 font-bold uppercase tracking-wider ltr-text">{{ ex.nameEn }}</span>
                            </div>
                        </div>
                        <p class="text-slate-600 text-sm leading-relaxed pr-11 border-r-2 border-cyan-100 mr-4">{{ ex.instruction }}</p>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <button @click="toggleGuide" class="guide-btn fixed bottom-8 left-8 z-50 bg-cyan-600 text-white px-6 py-4 rounded-full shadow-2xl hover:bg-cyan-700 transition-all hover:scale-105 flex items-center gap-3 float-anim">
        <span class="text-4xl">๐</span>
        <div class="text-right">
            <div class="text-xs font-light opacity-90">ูุณุงุนุฏุฉ</div>
            <div class="font-bold text-lg">ุฏููู ุงูุงุณุชุฎุฏุงู</div>
        </div>
    </button>

    <div v-if="showGuide" class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4" @click.self="toggleGuide">
        <div class="bg-white w-full max-w-6xl h-[85vh] rounded-[30px] p-0 shadow-2xl relative animate-fade-in-up border-4 border-cyan-50 overflow-hidden flex flex-col">
            <div class="bg-slate-100 p-4 flex justify-between items-center border-b border-slate-200">
                <h2 class="text-xl font-bold text-slate-700 flex items-center gap-2">
                    <span>๐</span> ุฏููู ุงููุนูุงุฑู (The Manual)
                </h2>
                <button @click="toggleGuide" class="bg-white rounded-full p-2 text-slate-500 hover:bg-red-50 hover:text-red-500 transition-colors shadow-sm w-10 h-10 flex items-center justify-center font-bold">โ</button>
            </div>
            
            <div class="flex-1 bg-slate-50 relative">
                <iframe src="https://drive.google.com/file/d/1lLlmpMWEpmlzaxhrhYQVfu_vXWmaxrlb/preview" class="w-full h-full" frameborder="0">
                    <div class="flex flex-col items-center justify-center h-full p-10 text-center">
                        <p class="text-slate-500 mb-4">ูุชุตูุญู ูุง ูุฏุนู ุนุฑุถ PDF ูุจุงุดุฑุฉ.</p>
                        <a href="https://drive.google.com/file/d/1lLlmpMWEpmlzaxhrhYQVfu_vXWmaxrlb/view?usp=sharing" target="_blank" class="bg-blue-600 text-white px-6 py-3 rounded-xl font-bold">ุชุญููู ุงูุฏููู</a>
                    </div>
                </iframe>
            </div>

            <div class="bg-white p-4 border-t border-slate-200 text-center md:text-right">
                <a href="https://drive.google.com/file/d/1lLlmpMWEpmlzaxhrhYQVfu_vXWmaxrlb/view?usp=sharing" target="_blank" class="inline-flex items-center gap-2 text-blue-600 font-bold hover:underline">
                    <span>๐ฅ</span> ุชุญููู ููู PDF
                </a>
            </div>
        </div>
    </div>

</div>

<script>
const { createApp } = Vue;

createApp({
    data() {
        return {
            currentPhase: 'intro',
            historyIndex: -1, 
            physicalIndex: 0,
            user: { name: '', age: '' },
            disclaimerAccepted: false,
            safetyPassed: true,
            
            // Logs
            failedTests: [], 
            physicalLog: [],
            currentTestResult: null,
            lastAnswerNote: null,
            showProgram: false,
            showGuide: false, // New state
            
            // Level Display Logic
            displayedLevel: null,

            // === 1. SAFETY CHECK ===
            historyQuestions: [
                { text: 'ูู ุงูุฃูู ุญุงุฏ ุฌุฏุงู ูุฏุฑุฌุฉ ุชููุนู ูู ุงูุญุฑูุฉ ุชูุงูุงูุ', options: [{ label: 'ูุนู', flag: true, note: 'ุฃูู ุญุงุฏ ูุชุทูุจ ุฑุงุญุฉ.' }, { label: 'ูุง', flag: false, note: 'ููููู ุงููุชุงุจุนุฉ.' }] },
                { text: 'ูู ุฃุฌุฑูุช ุฌุฑุงุญุฉ ุจุงูุธูุฑ ูุคุฎุฑุงู (3 ุฃุดูุฑ)ุ', options: [{ label: 'ูุนู', flag: true, note: 'ุงุณุชุดุฑ ุฌุฑุงุญู.' }, { label: 'ูุง', flag: false, note: 'ุขูู.' }] },
                { text: 'ูู ููุงู ุชูููู ูุถุนู ุดุฏูุฏ ูู ุงูุณุงูููุ', options: [{ label: 'ูุนู', flag: true, note: 'ุนูุงูุฉ ุนุตุจูุฉ ุญูุฑุงุก.' }, { label: 'ูุง', flag: false, note: 'ุขูู.' }] }
            ],

            // === 2. KRAUS-WEBER TESTS (Deep Explanation) ===
            physicalTests: [
                { 
                    id: 'kw1', title: '1. ุงูุจุทู ูุงูุณุงููู ููุฏูุฏุชูู (Abs+Psoas)', image: 'img/test1.jpg', 
                    instruction: `<ul><li>ุงุณุชููู ุนูู ุธูุฑูุ ูุฏูู ุฎูู ุฑูุจุชูุ ูุณุงููู ููุฏูุฏุชูู.</li><li>ุซุจุช ูุฏููู (ุชุญุช ููุจุฉ ุฃู ุจูุณุงุนุฏุฉ ุดุฎุต).</li><li>ุญุงูู ุงูุฌููุณ ุญุชู ูุถุนูุฉ ุงูุฌููุณ ุงููุงููุฉ.</li></ul>`, 
                    question: 'ูู ูุฌุญุช ูู ุงูุฌููุณุ', 
                    options: [ 
                        { 
                            label: 'ูุนู', passed: true, 
                            feedback: 'ููุชุงุฒ. ูุฐุง ูุนูู ุฃู ุนุถูุงุช ุงูุจุทู (Abs) ูุนุถูุงุช ุงููุฑู (Psoas) ุชุนููุงู ุจุชูุงุบู ุฌูุฏ ูุฑูุน ุฌุฐุนู ุถุฏ ุงูุฌุงุฐุจูุฉ.',
                            dos: ['ุญุงูุธ ุนูู ูุฐุง ุงููุณุชูู'], 
                            avoids: [] 
                        }, 
                        { 
                            label: 'ูุง', passed: false, 
                            feedback: 'ูุง ุชูููุ ูุฐุง ุดุงุฆุน. ูุดู ูุฐุง ุงูุงุฎุชุจุงุฑ ูุนูู ุฃู ุนุถูุงุช ุงูุจุทู ูุฏูู ููุณุช ูููุฉ ุจูุง ูููู ูุฑูุน ูุฒู ุฌุฐุนูุ ุฃู ุฃู ุนุถูุงุช ุงููุฑู ุถุนููุฉ ุฌุฏุงู ูููุณุงุนุฏุฉ. ูุฐุง ุงูุถุนู ูุถุน ุถุบุทุงู ูุจุงุดุฑุงู ุนูู ููุฑุงุช ุงูุธูุฑ.', 
                            dos: ['ุชูุงุฑูู ุงููุณุชูู 1 ูุชูููุฉ ุงูุจุทู ุชุฏุฑูุฌูุงู'], 
                            avoids: ['ุชูุงุฑูู ุงูุจุทู ุงููุงููุฉ (Full Sit-ups) ุญุงููุงู ูุฃููุง ูุฏ ุชุคุฐู ุธูุฑู'] 
                        } 
                    ] 
                },
                { 
                    id: 'kw2', title: '2. ุงูุจุทู ูุน ุซูู ุงูุฑูุจุฉ (Pure Abs)', image: 'img/test2.jpg', 
                    instruction: `<ul><li>ุงุณุชููู ุนูู ุธูุฑู ูุงุซูู ุฑูุจุชูู.</li><li>ุซุจุช ูุฏููู.</li><li>ุญุงูู ุงูุฌููุณ ุจุงููุงูู ุฏูู ุงุณุชุฎุฏุงู ุงููุฏูู.</li></ul>`, 
                    question: 'ูู ูุฌุญุชุ', 
                    options: [ 
                        { 
                            label: 'ูุนู', passed: true, 
                            feedback: 'ุฑุงุฆุน. ุซูู ุงูุฑูุจุชูู ููุบู ูุณุงุนุฏุฉ ุงูุณุงูููุ ูุฐุง ูุฌุงุญู ููุง ูุนูู ุฃู ุนุถูุงุช ุจุทูู "ุงููุนุฒููุฉ" ูููุฉ ุจูุง ูููู.', 
                            dos: [], 
                            avoids: [] 
                        }, 
                        { 
                            label: 'ูุง', passed: false, 
                            feedback: 'ูุฐุง ุงูุชุดุงู ููู ุฌุฏุงู. ูุดูู ููุง ูุนูู ุฃู ุนุถูุงุช ุจุทูู ูุญุฏูุง (ุจุฏูู ูุณุงุนุฏุฉ ุงูุณุงููู) ูุง ุชุณุชุทูุน ุฏุนู ุนููุฏู ุงูููุฑู. ูุฐุง ุงูุถุนู ูู ุณุจุจ ุฑุฆูุณู ููุชุนุจ ุงููููู ูู ุงูุธูุฑ.', 
                            dos: ['ุชูุฑูู ุงูุจุทู ุงูุฌุฒุฆู (Crunch) ูุชูููุฉ ุงูุนุถูุฉ ุงููุณุชูููุฉ'], 
                            avoids: ['ุญูู ุงูุฃูุฒุงู ูุฃูุช ูุงูู ููุชุฑุงุช ุทูููุฉ'] 
                        } 
                    ] 
                },
                { 
                    id: 'kw3', title: '3. ุฑูุน ุงูุณุงููู (Lower Abs)', image: 'img/test3.jpg', 
                    instruction: `<ul><li>ุงุณุชููู ุนูู ุธูุฑูุ ุณุงููู ููุฏูุฏุชูู.</li><li>ุงุฑูุน ุณุงููู 25 ุณู ุนู ุงูุฃุฑุถ ููุฏุฉ 10 ุซูุงูู.</li><li>ูุฌุจ ุฃูุง ูุชููุณ ุธูุฑู.</li></ul>`, 
                    question: 'ูู ุตูุฏุช 10 ุซูุงูู ุฏูู ุชููุณ ุงูุธูุฑุ', 
                    options: [ 
                        { 
                            label: 'ูุนู', passed: true, 
                            feedback: 'ุซุจุงุช ููุชุงุฒ. ุนุถูุงุช ุฃุณูู ุงูุจุทู ูููุฉ ูุชููุน ุงูุญูุถ ูู ุงููููุงู.', 
                            dos: [], 
                            avoids: [] 
                        }, 
                        { 
                            label: 'ูุง', passed: false, 
                            feedback: 'ุนูุฏูุง ุฑูุนุช ุณุงูููุ ุชููุณ ุธูุฑู ููุฃุนููุ ุตุญูุญุ ูุฐุง ูุนูู ุฃู ุนุถูุงุช ุฃุณูู ุงูุจุทู ุถุนููุฉ ููุดูุช ูู ุชุซุจูุช ุงูุญูุถ. ูุฐุง ุงูุถุนู ูุณุจุจ "ูููุงู ุงูุญูุถ ุงูุฃูุงูู" ูุขูุงู ุฃุณูู ุงูุธูุฑ ุนูุฏ ุงููููู.', 
                            dos: ['ุชูุฑูู ุฑูุน ุฑูุจุฉ ูุงุญุฏุฉ ููุตุฏุฑ'], 
                            avoids: ['ุฑูุน ุงูุณุงููู ุงููุฒุฏูุฌ ูุฃูู ูุถุบุท ุงูููุฑุงุช ุญุงููุงู'] 
                        } 
                    ] 
                },
                { 
                    id: 'kw4', title: '4. ุฑูุน ุงูุธูุฑ ุงูุนููู', image: 'img/test4.jpg', 
                    instruction: `<ul><li>ุงุณุชููู ุนูู ุจุทูู (ูุณุงุฏุฉ ุชุญุช ุงูุญูุถ).</li><li>ุงุฑูุน ุฑุฃุณู ููุชููู ุนู ุงูุฃุฑุถ ููุฏุฉ 10 ุซูุงูู.</li></ul>`, 
                    question: 'ูู ุตูุฏุช 10 ุซูุงููุ', 
                    options: [ 
                        { 
                            label: 'ูุนู', passed: true, 
                            feedback: 'ุนุถูุงุช ุงูุธูุฑ ุงูุนูููุฉ ูููุฉ ูุชุฏุนู ุงูุฑูุจุฉ ุฌูุฏุงู.', 
                            dos: [], 
                            avoids: [] 
                        }, 
                        { 
                            label: 'ูุง', passed: false, 
                            feedback: 'ุถุนู ุนุถูุงุช ุงูุธูุฑ ุงูุนูููุฉ ุดุงุฆุน ุฌุฏุงู ุจุณุจุจ ุงุณุชุฎุฏุงู ุงูููุงุชู ูุงูููุจููุชุฑ. ูุฐุง ุงูุถุนู ูุณุจุจ ุงูุชุญุฏุจ ููุฒูุฏ ุงูุญูู ุนูู ุงูุฑูุจุฉ ูุฃุณูู ุงูุธูุฑ ููุชุนููุถ.', 
                            dos: ['ุชูุฑูู ูุถุนูุฉ ุงูููุจุฑุง ุงูุจุณูุทุฉ', 'ุชูุงุฑูู ูุชุญ ุงูุตุฏุฑ'], 
                            avoids: ['ุงูุฌููุณ ุงูุทููู ุจุธูุฑ ููุญูู'] 
                        } 
                    ] 
                },
                { 
                    id: 'kw5', title: '5. ุฑูุน ุงูุธูุฑ ุงูุณููู', image: 'img/test5.jpg', 
                    instruction: `<ul><li>ุงุณุชููู ุนูู ุจุทูู.</li><li>ุงุฑูุน ุณุงููู ุงููุณุชูููุชูู ูุนุงู ููุฏุฉ 10 ุซูุงูู.</li></ul>`, 
                    question: 'ูู ูุฌุญุชุ', 
                    options: [ 
                        { 
                            label: 'ูุนู', passed: true, 
                            feedback: 'ุนุถูุงุช ุฃุณูู ุงูุธูุฑ ูููุฉ ูุชุนูู ูุฏุนุงูุงุช ุฌูุฏุฉ ููุนููุฏ ุงูููุฑู.', 
                            dos: [], 
                            avoids: [] 
                        }, 
                        { 
                            label: 'ูุง', passed: false, 
                            feedback: 'ุนุถูุงุช ุฃุณูู ุงูุธูุฑ ูู "ุญุจุงู ุงูุชุซุจูุช" ููุนููุฏ ุงูููุฑู. ุถุนููุง ูุนูู ุฃู ุนููุฏู ุงูููุฑู ูุฑุชูุฒ ุนูู ุงูุฃุฑุจุทุฉ ูุงูุนุธุงู ููุทุ ููุง ูุณุจุจ ุงูุฃูู ุนูุฏ ุงููููู ุฃู ุงููุดู.', 
                            dos: ['ุชูุฑูู ุงููุทุฉ ูุงูุฌูู (Cat-Cow) ูุชูููุฉ ุงูููุทูุฉ ุจูุทู'], 
                            avoids: ['ุงูุงูุญูุงุก ุงูููุงุฌุฆ ูุงูุชูุงุท ุงูุฃุดูุงุก'] 
                        } 
                    ] 
                },
                { 
                    id: 'kw6', title: '6. ุงููุฑููุฉ (Flexibility)', image: 'img/test6.jpg', 
                    instruction: `<ul><li>ูู ูุณุชูููุงู.</li><li>ุงูุญูู ูุญุงูู ููุณ ุงูุฃุฑุถ ุจุฃุทุฑุงู ุฃุตุงุจุนู ุฏูู ุซูู ุงูุฑูุจุฉ.</li></ul>`, 
                    question: 'ูู ููุณุช ุงูุฃุฑุถุ', 
                    options: [ 
                        { 
                            label: 'ูุนู', passed: true, 
                            feedback: 'ูุฑููุฉ ุทุจูุนูุฉ ููุชุงุฒุฉ. ุนุถูุงุชู ููุณุช ูุดุฏูุฏุฉ ุจุดูู ูุนูู ุงูุญุฑูุฉ.', 
                            dos: [], 
                            avoids: [] 
                        }, 
                        { 
                            label: 'ูุง', passed: false, 
                            feedback: 'ูุฐุง ูุนูู ุฃู ูุฏูู "ุชุดูุฌุงู" (Stiffness) ูู ุงูุนุถูุงุช ุงูุฎูููุฉ (ุงูุธูุฑ ูุงููุฎุฐูู). ุชุฎูู ุนููุฏู ุงูููุฑู ูููุณ ูุดุฏูุฏ ุฌุฏุงูุ ูุฐุง ุงูุดุฏ ูุถุบุท ุงูุบุถุงุฑูู ุทูุงู ุงูููู ุญุชู ูุฃูุช ูุฑุชุงุญ.', 
                            dos: ['ุชูุงุฑูู ุงูุงุณุชุฑุฎุงุก ูุงูุชููุณ (ุงููุณุชูู 1) ููู ุงูุชุดูุฌ'], 
                            avoids: ['ุชูุงุฑูู ุงูููุฉ ุงูุนูููุฉ ูุจู ุงุณุชุนุงุฏุฉ ุงููุฑููุฉ'] 
                        } 
                    ] 
                }
            ],

            // === 3. DETAILED EXERCISE DATABASE ===
            levels: {
                1: {
                    id: 1, name: "ุงููุณุชูู ุงูุฃูู: ุงูุงุณุชุฑุฎุงุก (Relaxation)", focus: "ูู ุงูุชุดูุฌ ูุงูุชููุณ",
                    video: "https://www.tiktok.com/@rafiqbens/video/7433507833930452229",
                    exercises: [
                        { nameEn: "Diaphragmatic Deep Breathing", nameAr: "ุงูุชููุณ ุงูุนููู ูู ุงูุญุฌุงุจ ุงูุญุงุฌุฒ", instruction: "ุงุณุชููู ุนูู ุธูุฑูุ ูุงุซูู ุฑูุจุชูู. ุชููุณ ุจุนูู ูู ุฃููู ุญุชู ุชุฑุชูุน ูุนุฏุชู (ูููุณ ุตุฏุฑู). ุงุฒูุฑ ุจุจุทุก ูู ููู." },
                        { nameEn: "Deep Breathing with Shoulder Shrugs", nameAr: "ุงูุชููุณ ูุน ูุฒ ุงูุฃูุชุงู", instruction: "ุฃุซูุงุก ุงูุดูููุ ุงุฑูุน ูุชููู ูุญู ุฃุฐููู ูุงุซุจุช ูุญุธุฉ. ุฃุซูุงุก ุงูุฒููุฑุ ุฃุฑุฎู ูุชููู ุชูุงูุงู ููุฃุณูู." },
                        { nameEn: "Frog-Leg Release", nameAr: "ุงุณุชุฑุฎุงุก ูุถุนูุฉ ุงูุถูุฏุน", instruction: "ุงุณุชููู ุนูู ุธูุฑู. ุฏุน ุฑูุจุชู ุงููููู ุชุณูุท ููุฌุงูุจ (ูุงูุถูุฏุน). ุญุฑู ูุฏูู ููุฃุณูู ูุชูุฏูุฏ ุงูุณุงูุ ุซู ุฃุนุฏูุง ููุถุนูุฉ ุงูุจุฏุงูุฉ. ูุฑุฑ ูููุณุงุฑ." },
                        { nameEn: "Head Rotation", nameAr: "ุชุฏููุฑ ุงูุฑุฃุณ", instruction: "ุงุณุชููู ุจุงุณุชุฑุฎุงุก. ุฃุฏุฑ ุฑุฃุณู ุจุจุทุก ูููุณุงุฑ ุซู ูููููู. ุงููุฏู ูู ุฅุฑุฎุงุก ุนุถูุงุช ุงูุฑูุจุฉ ุงููุชุดูุฌุฉ." },
                        { nameEn: "Knee-to-Chest Leg Release", nameAr: "ุถู ุงูุฑูุจุฉ ุซู ุงูุงุณุชุฑุฎุงุก", instruction: "ุงุฑูุน ุฑูุจุชู ูุตุฏุฑูุ ุซู ุฏุนูุง ุชุณูุท ููุฌุงูุจ (ูุถุนูุฉ ุงูุถูุฏุน) ูุชูุฒูู ููุฃุณูู ุญุชู ุชุณุชููู ุงูุณุงู." },
                        { nameEn: "Side Slide", nameAr: "ุงูุงูุฒูุงู ุงูุฌุงูุจู", instruction: "ูู ุนูู ุฌูุจู. ุฒุญูู ุณุงูู ุงูุนููุง ูุญู ุตุฏุฑู (ููู ุชูุงูุณ ุงูุณุงู ุงูุณููู)ุ ุซู ุฒุญูููุง ููุฃุณูู ุญุชู ุชุณุชููู." },
                        { nameEn: "Buttocks Squeeze", nameAr: "ุนุตุฑ ุงูุนุถูุงุช ุงูุฃูููุฉ", instruction: "ุงุณุชููู ุนูู ุจุทูู (ูุน ูุณุงุฏุฉ ุชุญุช ุงูุญูุถ). ุงุนุตุฑ ุนุถูุงุช ุงููุคุฎุฑุฉ ุจููุฉ ููุฏุฉ 3 ุซูุงูู ุซู ุงุณุชุฑุฎู." }
                    ]
                },
                2: {
                    id: 2, name: "ุงููุณุชูู ุงูุซุงูู: ุชูููุฉ ุฃูููุฉ (Mobilization)", focus: "ุชุญุฑูู ุงูุญูุถ ูุชูููุฉ ุงูุฌุฐุน",
                    video: "https://www.tiktok.com/@rafiqbens/video/7433508131923135750",
                    exercises: [
                        { nameEn: "Double Knee to Chest", nameAr: "ุถู ุงูุฑูุจุชูู ููุตุฏุฑ", instruction: "ุงุณุชููู ุนูู ุธูุฑู. ุถู ููุชุง ุฑูุจุชูู ุฅูู ุตุฏุฑู ูุฏุฑ ุงูุฅููุงู. ุฃูุฒูููุง ุจุจุทุก." },
                        { nameEn: "Cat Back-Camel Back", nameAr: "ุชูุฑูู ุงููุทุฉ ูุงูุฌูู", instruction: "ุนูู ูุฏูู ูุฑูุจุชูู. ููุณ ุธูุฑู ููุฃุนูู (ููุทุฉ ุบุงุถุจุฉ) ูุฃุณูุท ุฑุฃุณู. ุซู ุงุนูุณ ุงูุญุฑูุฉ (ูุฌูู) ูุงุฑูุน ุฑุฃุณู." },
                        { nameEn: "Partial Sit-Up", nameAr: "ุชูุฑูู ุงูุจุทู ุงูุฌุฒุฆู", instruction: "ุงุณุชููู ูุน ุซูู ุงูุฑูุจุชูู. ุฒุญูู ูุฏูู ุนูู ูุฎุฐูู ูุงุฑูุน ุฑุฃุณู ููุชููู ููุท ุนู ุงูุฃุฑุถ. ูุง ุชูู ุจุฌููุณ ูุงูู." },
                        { nameEn: "Pectoral Stretch", nameAr: "ุฅุทุงูุฉ ุนุถูุงุช ุงูุตุฏุฑ", instruction: "ูู ูุถุนูุฉ ุงูุฑููุนุ ูุฏ ูุฏูู ููุฃูุงู ุจุนูุฏุงู ุนูู ุงูุฃุฑุถุ ูุฃูุฒู ุตุฏุฑู ูุญู ุงูุฃุฑุถ ูุชุดุนุฑ ุจุงูุฅุทุงูุฉ." },
                        { nameEn: "Seated Forward Bend", nameAr: "ุงูุงูุญูุงุก ุงูุฃูุงูู (ุฌุงูุณ)", instruction: "ุงุฌูุณ ุนูู ูุฑุณู. ุงูุญูู ุจุฌุฐุนู ููุฃูุงู ุจูู ุฑูุจุชูู ูุฏุน ุฐุฑุงุนูู ุชุชุฏููุงู ูุญู ุงูุฃุฑุถ." },
                        { nameEn: "Bicycle Hamstring Stretch", nameAr: "ุฅุทุงูุฉ ุงููุฎุฐ ุงูุฎููู (ุงูุฏุฑุงุฌุฉ)", instruction: "ุงุณุชููู ุนูู ุธูุฑู. ุงุฑูุน ุณุงูุงู ูุงุญุฏุฉุ ุงูุฑุฏูุง ููุฃุนูู ูุฃุตุงุจุน ูุฏูู ุชุดูุฑ ููุณูู. ุฃูุฒููุง ูุณุชูููุฉ." },
                        { nameEn: "Bicycle Calf Stretch", nameAr: "ุฅุทุงูุฉ ุงูุณุงู (ุงูุฏุฑุงุฌุฉ)", instruction: "ููุณ ุงูุชูุฑูู ุงูุณุงุจูุ ููู ุงุฌุนู ูุนุจ ูุฏูู ูุดูุฑ ููุณูู (ูููุณ) ูุชูุฏูุฏ ุจุทุฉ ุงูุณุงู." }
                    ]
                },
                3: {
                    id: 3, name: "ุงููุณุชูู ุงูุซุงูุซ: ูุชูุฏู (Maintenance)", focus: "ุงููุฑููุฉ ูุงูููุฉ ุงููุงููุฉ",
                    video: "https://www.tiktok.com/@rafiqbens/video/7433509123074854150",
                    exercises: [
                        { nameEn: "Full Sit-Up", nameAr: "ุชูุฑูู ุงูุจุทู ุงููุงูู", instruction: "ุงุณุชููู ูุน ุชุซุจูุช ูุฏููู ุชุญุช ููุจุฉ. ุถุน ูุฏูู ุฎูู ุฑูุจุชู ูุงุฌูุณ ุฌูุณุฉ ูุงููุฉ." },
                        { nameEn: "Seated Side Bend", nameAr: "ุงูุงูุญูุงุก ุงูุฌุงูุจู (ุฌุงูุณ)", instruction: "ุงุฌูุณ ุนูู ูุฑุณู. ุงูุญูู ุจุฌุฐุนู ููุฌุงูุจ ุงูุฃููู ูุญุงููุงู ููุณ ุงูุฃุฑุถ ุจูุฏูุ ุซู ูุฑุฑ ูููุณุงุฑ." },
                        { nameEn: "Straight Leg Raise Hamstring", nameAr: "ุฑูุน ุงูุณุงู ุงููุณุชูููุฉ (ูุฎุฐ)", instruction: "ุงุฑูุน ุณุงูู ุงููุณุชูููุฉ ููุฃุนูู ูุฏุฑ ุงูุฅููุงู ูุฃุตุงุจุนู ููุฑูุฏุฉ (Pointing)." },
                        { nameEn: "Straight Leg Raise Calf", nameAr: "ุฑูุน ุงูุณุงู ุงููุณุชูููุฉ (ุจุทุฉ ุงูุณุงู)", instruction: "ุงุฑูุน ุณุงูู ุงููุณุชูููุฉ ููุฃุนูู ูุน ุฏูุน ุงููุนุจ ููุฃุนูู (Flexing) ูุดุฏ ุงูุณุงู ุงูุฎูููุฉ." },
                        { nameEn: "Diverโs Bend", nameAr: "ุงูุญูุงุก ุงูุบูุงุต", instruction: "ููุ ุงุดุจู ูุฏูู ุฎูู ุธูุฑู. ุงูุญูู ููุฃูุงู ูู ุงูุญูุถ ูุงุฑูุน ูุฏูู ุงููุดุจููุชูู ููุฃุนูู ุฎููู." },
                        { nameEn: "Wall Calf Stretch", nameAr: "ุฅุทุงูุฉ ุงูุณุงู ุนูู ุงูุญุงุฆุท", instruction: "ูู ุฃูุงู ุญุงุฆุท. ุถุน ูุฏูู ุนููู. ุงุฑุฌุน ุจุณุงู ูุงุญุฏุฉ ููุฎูู ูุน ุฅุจูุงุก ุงููุนุจ ุนูู ุงูุฃุฑุถ ูุดุฏ ุจุทุฉ ุงูุณุงู." },
                        { nameEn: "Floor Touch", nameAr: "ููุณ ุงูุฃุฑุถ", instruction: "ูู ุจุงุณุชูุงูุฉ. ุงูุญูู ููุฃูุงู ูุญุงูู ููุณ ุงูุฃุฑุถ ุจุฃุทุฑุงู ุฃุตุงุจุนู ูุน ุงูุญูุงุธ ุนูู ุงูุฑูุจุชูู ููุฑูุฏุชูู." }
                    ]
                }
            }
        }
    },
    computed: {
        currentHistoryQ() { return this.historyQuestions[this.historyIndex]; },
        currentPhysicalTest() { return this.physicalTests[this.physicalIndex]; },
        progress() {
            const total = 1 + this.historyQuestions.length + this.physicalTests.length;
            let current = this.currentPhase === 'intro' ? 0 : this.currentPhase === 'history' ? 1 + this.historyIndex : 1 + this.historyQuestions.length + this.physicalIndex;
            return (current / total) * 100;
        },
        failedTestsCount() {
            return this.physicalLog.filter(t => t.isPain).length;
        },
        diagnosisTitle() { return this.failedTestsCount > 0 ? "ุชุญุช ุงููุณุชูู (Below Par)" : "ูุณุชูู ุงูุตูุงูุฉ (Good)"; },
        diagnosisSubtitle() { return this.failedTestsCount > 0 ? `ูุดูุช ูู ${this.failedTestsCount} ูู ุฃุตู 6 ุงุฎุชุจุงุฑุงุช. ุนุถูุงุชู "Soft Tissue" ุชุญุชุงุฌ ูุฅุนุงุฏุฉ ุชุฃููู.` : "ูุฌุญุช ูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช. ููููู ุงูุญูุงุธ ุนูู ุตุญุฉ ุธูุฑู ุจุงููุณุชูู ุงููุชูุฏู."; },
        // Default recommendation based on logic
        recommendedLevel() { return this.failedTestsCount > 0 ? this.levels[1] : this.levels[2]; } 
    },
    methods: {
        startApp() { this.currentPhase = 'history'; },
        handleHistoryAnswer(option) {
            if (option.flag) { this.safetyPassed = false; return; }
            this.lastAnswerNote = option.note;
        },
        nextHistoryQuestion() {
            this.lastAnswerNote = null;
            if (this.historyIndex < this.historyQuestions.length - 1) this.historyIndex++;
            else this.currentPhase = 'physical';
        },
        handlePhysicalAnswer(option) {
            this.currentTestResult = option;
            this.physicalLog.push({ title: this.currentPhysicalTest.title, passed: option.passed });
            // "isPain" is essentially "Failed Test" in this context
            this.physicalLog[this.physicalLog.length - 1].isPain = !option.passed; 
            
            if (!option.passed) this.failedTests.push({ name: this.currentPhysicalTest.title, reason: option.feedback });
        },
        nextPhysicalTest() {
            this.currentTestResult = null;
            if (this.physicalIndex < this.physicalTests.length - 1) {
                this.physicalIndex++;
            } else {
                this.currentPhase = 'final';
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#06b6d4', '#0ea5e9'] });
            }
        },
        toggleProgram() { 
            // Default to recommended if no specific one clicked
            if(!this.displayedLevel) this.displayedLevel = this.recommendedLevel;
            this.showProgram = !this.showProgram; 
        },
        openSpecificLevel(id) {
            this.displayedLevel = this.levels[id];
            this.showProgram = true;
        },
        toggleGuide() { this.showGuide = !this.showGuide; }, // Toggle Guide
        resetApp() { location.reload(); }
    }
}).mount('#app');
</script>

</body>
</html>
